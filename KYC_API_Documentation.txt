# KYC System API Documentation for Frontend Developers

## 1. Overview
The KYC system is session-based and supports a 14-step workflow. Users can be authenticated or guests (using email/OTP). All data is progressively saved per step.

**Base URL:** `https://your-api-domain.com/api`

---

## 2. Session Management (KycSessionController)

### Initialize/Resume Session
If the user is logged in, use the `KycController` (see Section 4). For guests:
- **Endpoint:** `POST /KycSession/initialize`
- **Body:** `{ "email": "user@example.com", "mobileNo": "98XXXXXXXX" }`
- **Response:** Returns `sessionId`, `sessionToken`, and `currentStep`.

### Track Progress
Call this to see which steps are completed.
- **Endpoint:** `GET /KycSession/progress/{sessionId}`
- **Response:** Returns a list of all 14 steps with `isCompleted`, `isSaved`, and `recordId`.

---

## 3. Saving & Fetching Data (KycDataController)

### Fetch All Saved Data (Pre-fill Form)
Use this when a user returns to a session to pre-fill all 14 steps at once.
- **Endpoint:** `GET /KycData/all-details/{sessionId}`
- **Response:** Returns a single object containing `personalInfo`, `currentAddress`, `bank`, etc. If a step is not yet started, its object will be `null`.

### Saving Data (Per Step)
**Common Request Format:**
```json
{
  "sessionId": 123,
  "data": { ...step specific fields... }
}
```
**Endpoints:**
1.  **Personal Info:** `POST /KycData/save-personal-info`
2.  **Current Address:** `POST /KycData/save-current-address`
3.  **Permanent Address:** `POST /KycData/save-permanent-address`
4.  **Family Members:** `POST /KycData/save-family`
5.  **Bank Account:** `POST /KycData/save-bank-account`
6.  **Occupation:** `POST /KycData/save-occupation`
7.  **Financial Details:** `POST /KycData/save-financial-details`
8.  **Transaction Info:** `POST /KycData/save-transaction-info`
9.  **Guardian:** `POST /KycData/save-guardian`
10. **AML Compliance:** `POST /KycData/save-aml-compliance`
11. **Document Upload:** `POST /KycData/upload-document` (Use **Multipart/Form-Data**)
    - Form Fields: `sessionId` (int), `documentType` (byte), `file` (File)
12. **Location Map:** `POST /KycData/save-location-map`
13. **Declarations:** `POST /KycData/save-declarations`
14. **Agreement:** `POST /KycData/save-agreement`

---

## 4. Final Submission (KycController)

### Get Active Session (For Logged-in Users)
- **Endpoint:** `GET /Kyc/my-session`
- **Action:** If the user is logged in via JWT, call this to get their `sessionId`.

### Submit for Review
- **Endpoint:** `POST /Kyc/submit/{sessionId}`
- **Action:** Call this after step 14 is saved to lock the form for review.
